function Lab12_2

X = [0.0004   -5.1565   -5.3179   -5.6746   -8.3169   -6.8784   -8.9582   -4.8472   -6.9126   -6.4293   -4.9017  ...
    -8.5695   -4.0592   -1.5231   -7.0771   -0.5792   -9.1109   -5.2734   -9.9593   -7.3519   -9.9844   -7.7298 ...
    -8.2902   -6.7831   -7.9013   -8.3362   -2.8134    0.8127    1.2726   -7.3458   -4.2079   -5.4879   -3.7146  ...
    -6.8215   -9.1797   -4.7641   -7.9138   -9.6867    1.4561   -4.8328    1.5387   -0.8510   -9.9118   -1.8395  ...
    -1.5286   -2.2585   -3.3723   -7.3827   -0.7316   -7.2637   -5.5496    0.6911    0.2765   -5.1708   -6.1838  ...
    -2.6964    0.9223    0.9092   -2.9009   -6.0091    0.2368   -4.6912    0.8523   -9.6018   -3.6109   -1.4020  ...
    -7.8484   -5.9616   -7.7474   -6.1369   -5.1537   -3.4172   -9.4151   -3.3672   -6.7023   -7.1020   -7.0823  ...
    -8.1501    1.4770    1.2279   -0.1754   -1.2609   -7.8903   -5.6755   -7.7345   -9.9856   -6.2030   -1.6046  ...
    -2.4969   -3.4833   -4.7316   -6.5509   -3.9801   -0.8614   -0.8511   -3.0873   -1.0280   -2.2536   -8.5214  -3.9472];

alpha = 0.01;
n = length(X);
k = round(1 + log2(n));
N = hist(X,k);

a_ = min(X);
b_ = max(X);
l = 2;

x = linspace(min(X),max(X),k + 1);

p_i0 = zeros(1,k);
for i = 1:k
    p_i0(i) = ContinuousCDF(x(i+1),'uniform', [a_,b_]) - ContinuousCDF(x(i),'uniform', [a_,b_]);
end

chi2_value = sum(((N - n .* (p_i0)) .^2) ./ (n .* (p_i0)))
chi2_quantile = chi2inv(1 - alpha, k - l - 1)

if chi2_value < chi2_quantile
    disp('Egyenletes eloszlasra illeszkedik, melynek parameterei:');
    disp(a_);
    disp(b_);
else
    disp('NEM egyenletes eloszlasra illeszkedik');
end

end
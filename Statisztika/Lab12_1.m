function Lab12_1

X = [0.702 0.876 0.358 0.662 0.515 0.573 0.271 0.662 0.739 0.742...
0.667 0.552 0.509 0.148 0.591 0.818 0.597 0.579 0.499 0.721...
0.510 0.603 0.640 0.526 0.420 0.225 0.350 0.468 0.377 0.418...
0.870 0.758 0.726 0.829 0.376 0.351 0.541 0.511 0.652 0.749...
0.465 0.521 0.691 0.572 0.719 0.710 0.326 0.639 0.665 0.587...
0.354 0.704 0.276 0.707 0.711 0.652 0.748 0.627 0.516 0.681...
0.397 0.684 0.404 0.611 0.704 0.532 0.575 0.788 0.846 0.241...
0.558 0.704 0.594 0.663 0.635 0.832 0.270 0.913 0.600 0.471...
0.770 0.768 0.854 0.559 0.197 0.787 0.667 0.703 0.788 0.717...
0.325 0.406 0.698 0.538 0.524 0.511 0.876 0.591 0.790 0.964...
0.640 0.640 0.590 0.299 0.925 0.650 0.670 0.612 0.548 0.854...
0.772 0.657 0.458 0.467 0.797 0.615 0.312 0.478 0.274 0.680];

alpha = 0.02;
n = length(X);
k = round(1 + log2(n));
N = hist(X,k);

a_ = 4;
b_ = 3;

x = linspace(min(X),max(X),k + 1);

p_i0 = zeros(1,k);
for i = 1:k
    p_i0(i) = ContinuousCDF(x(i+1),'beta', [a_,b_]) - ContinuousCDF(x(i),'beta', [a_,b_]);
end

chi2_value = sum(((N - n .* (p_i0)) .^2) ./ (n .* (p_i0)))
chi2_quantile = chi2inv(1 - alpha, k - 1)

if chi2_value < chi2_quantile
    disp('Beta eloszlast kovet, melynek parameterei:');
    disp(a_);
    disp(b_);
else
    disp('NEM beta eloszlast kovet');
end

end
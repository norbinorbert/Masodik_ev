function Lab12_5(theta_)
f = @(x) ((3*x)/theta_^2) * exp(-(3*x^2)/(2*theta_^2));

n_ = 10000;
Y = ExactInversion('Lab12_5', theta_, n_);
hist(Y, 25);
theta = sqrt((3/(2*n_)) * sum(Y.^2))

X = [4.8265 3.3728 1.2175 3.6561 3.1020 0.8184 1.6251 0.9638...
2.1492 1.4815 2.6561 4.4046 1.4446 2.0589 3.3963 5.1522...
3.5165 1.8935 3.5354 1.5638 1.2813 1.7915 1.4926 3.0801...
5.0782 3.5739 2.4016 3.2928 4.4665 2.0226 3.7503 2.6500...
4.3595 0.7018 2.6349 1.8012 6.7715 4.8720 4.0928 2.7386...
3.1798 2.7115 2.7659 3.2924 1.1586 2.5286 0.9203 4.2963...
2.4577 0.4018 2.2402 5.8758 2.7302 2.4096 3.3828 0.3797...
2.2376 0.1310 2.8851 4.9420 2.3933 2.8426 3.6931 0.8081...
1.4119 0.2896 2.1006 5.6909 1.8988 3.8147 5.5321 3.6756...
5.0218 4.1563 0.9216 2.3044 0.5693 2.4442 2.0902 2.6890...
2.3208 3.6763 2.4177 1.7074 2.2270 0.9716 2.8557 2.9961...
1.4830 1.5756 5.4693 3.4844 3.7033 4.8776 4.2709 3.6077...
1.7101 3.2559 2.9108 4.7780 1.7047 2.2166 2.5840 0.5356...
2.9412 0.8276 0.6087 4.7066 1.9475 6.8767 1.3503 1.5852...
4.3639 2.3042 2.3530 3.9291 1.9120 2.5384 1.6980 2.7524...
2.6871 1.3077 3.7045 2.3749 4.5613 6.1833 2.8513 3.5291...
4.8290 3.0879 0.7378 2.4357];

alpha = 0.02;
n = length(X);
k = round(1 + log2(n));
N = hist(X,k);

theta = sqrt((3/(2*n)) * sum(X.^2));
l = 1;

x = linspace(min(X),max(X),k + 1);

F = @(x) 1 - exp((-3*x^2) / (2*theta^2));

p_i0 = zeros(1,k);
for i = 1:k
    p_i0(i) = F(x(i+1)) - F(x(i));
end

chi2_value = sum(((N - n .* (p_i0)) .^2) ./ (n .* (p_i0)))
chi2_quantile = chi2inv(1 - alpha, k - l - 1)

if chi2_value < chi2_quantile
    disp('A megadott eloszlasra illeszkedik, melynek parametere:');
    disp(theta);
else
    disp('NEM a megadott eloszlasra illeszkedik');
end

end